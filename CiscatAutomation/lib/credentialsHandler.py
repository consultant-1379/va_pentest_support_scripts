import json
import os


class CredentialHandler():

    def __init__(self, cred_file):
        self.credentials_file = cred_file
        with open(self.credentials_file, 'r') as credentials:
            self.cred = json.load(credentials)

    def saveCredentials(self):
        with open(self.credentials_file, 'w') as f:
            json.dump(self.cred, f, indent=4)

    def update(self, key, new_value):
        for entry in self.cred:
            if key in entry.keys():
                entry[key] = new_value
                self.saveCredentials()

    def update_with_filter(self, fkey, fval, key, new_value):
        for entry in self.cred:
            if key in entry.keys() and fkey in entry.keys() and entry[fkey] == fval:
                entry[key] = new_value
                self.saveCredentials()

if __name__ == '__main__':
    cred = CredentialHandler('/home/eenrmus/scriptCiscat/resources/vENM/c7b11/')
    cred.cred[0]['tags'] = 'external'
    cred.update('private_key', 'il file di chiavi')
    cred.saveCredentials()


