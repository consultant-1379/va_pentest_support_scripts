import json
import os
import requests
import re
import sys

class EnvInfo:
    url_for_sed = 'https://atvdit.athtem.eei.ericsson.se/api/documents/SED_ID'
    url_for_deployments_list ='https://atvdit.athtem.eei.ericsson.se/api/deployments'

    def __init__(self):
        self.instances = self._getInstancesInfoFromConf()
        pass

    def _getInstancesInfoFromConf(self):
        dict = {}
        with open(os.path.join(os.path.expanduser('~'), 'scriptCiscat', 'conf.json')) as conf:
            self.content = json.load(conf)
            for entry in self.content:
                    if not entry['target'] in dict.keys():
                        dict[entry['target']] = {}
                    if entry['target'] == 'vENM' or entry['target'] == 'siENM':
                        dict[entry['target']].update({entry['instance']: (entry['vnflafhost'],entry['vnflafuser'],entry['vnflafpem'])})
                    else:
                        dict[entry['target']].update(
                            {entry['instance']: (entry['lmihost'], entry['lmiuser'], entry['lmipassword'])})
            return dict

    def getInstancesList(self, target):
        if target in ['pENM', 'vENM', 'siENM']:
            return list(self.instances[target].keys())
    def getTargetsList(self):
        return list(self.instances.keys())

    def getDictionary(self, target):
        return self.instances[target]
if __name__ == '__main__':
    home = os.path.expanduser('~')
    deployment_info = EnvInfo()
    print(deployment_info.getInstancesList('pENM'))
    print(deployment_info.getInstancesList('vENM'))
    print(deployment_info.getInstancesList('siENM'))
    print(deployment_info.getTargetsList())


